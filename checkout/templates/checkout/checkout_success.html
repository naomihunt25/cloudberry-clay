{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'checkout/css/checkout.css' %}">
{% endblock %}

{% block content %}
<div class="overlay"></div>

<div class="container mt-5 pt-5">
  <!-- Thank You Header -->
  <div class="row text-center">
    <div class="col">
      <i class="fas fa-check-circle text-success fa-3x mb-3"></i>
      <h2 class="logo-font text-accent-blue mb-3">Thank You for Your Order</h2>
      <p class="text-muted mb-1">Your order has been placed successfully.</p>
      <p class="text-muted">
        A confirmation email has been sent to <strong>{{ order.email }}</strong>.
      </p>
      <hr class="w-50 mx-auto" style="border-color: var(--accent-pink);">
    </div>
  </div>

  <!-- Order Summary -->
  <div class="row justify-content-center mt-4">
    <div class="col-12 col-md-10 col-lg-8 bg-white shadow-sm rounded p-4">
      <h5 class="text-accent-blue mb-3">Order Summary</h5>

      <div class="mb-3">
        <p class="mb-1"><strong>Order Number:</strong> {{ order.order_number }}</p>
        <p class="mb-1"><strong>Order Date:</strong> {{ order.date|date:"j F Y, H:i" }}</p>
      </div>

      <hr>

      <!-- Items Ordered -->
      <h6 class="text-accent-blue mt-3 mb-2">Items Ordered</h6>
      {% for item in order.lineitems.all %}
      <div class="d-flex justify-content-between small border-bottom py-2">
        <span>{{ item.product.name }}{% if item.product_size %} (Size: {{ item.product_size|upper }}){% endif %}</span>
        <span>{{ item.quantity }} × £{{ item.product.price|floatformat:2 }}</span>
      </div>
      {% endfor %}

      <hr>

      <!-- Delivery Details -->
      <h6 class="text-accent-blue mt-3 mb-2">Delivery Details</h6>
      <p class="mb-0">{{ order.full_name }}</p>
      <p class="mb-0">{{ order.street_address1 }}</p>
      {% if order.street_address2 %}
        <p class="mb-0">{{ order.street_address2 }}</p>
      {% endif %}
      <p class="mb-0">{{ order.town_or_city }}{% if order.county %}, {{ order.county }}{% endif %}</p>
      <p class="mb-0">{{ order.postcode }}</p>
      <p class="mb-0">{{ order.country }}</p>
      <p class="mt-2"><strong>Phone:</strong> {{ order.phone_number }}</p>

      <hr>

      <!-- Totals -->
      <h6 class="text-accent-blue mt-3 mb-2">Order Total</h6>
      <div class="d-flex justify-content-between small">
        <p class="mb-1">Items:</p>
        <p class="mb-1">£{{ order.order_total|floatformat:2 }}</p>
      </div>
      <div class="d-flex justify-content-between small">
        <p class="mb-1">Delivery:</p>
        <p class="mb-1">£{{ order.delivery_cost|floatformat:2 }}</p>
      </div>
      <div class="d-flex justify-content-between font-weight-bold text-accent-blue mt-2">
        <p class="mb-1">Grand Total:</p>
        <p class="mb-1">£{{ order.grand_total|floatformat:2 }}</p>
      </div>

      <hr>

      <!-- Continue Shopping -->
      <div class="text-center mt-4">
        <a href="{% url 'products:products' %}"
           class="btn text-white rounded-pill px-4 py-2"
           style="background-color: var(--accent-blue); border: none;">
          <i class="fas fa-store mr-2"></i> Continue Shopping
        </a>
      </div>
    </div>
  </div>
</div>
{% endblock %}