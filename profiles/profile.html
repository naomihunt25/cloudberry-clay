{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'profiles/css/profile.css' %}">
{% endblock %}

{% block content %}
<div class="overlay"></div>
<div class="container mt-5 pt-5">
  <div class="row">
    <div class="col">
      <h2 class="logo-font text-accent-blue mb-4">My Profile</h2>
      <hr>
    </div>
  </div>

  <div class="row">
    <!-- Profile Form -->
    <div class="col-lg-6 mb-4">
      <h4 class="text-accent-pink">Default Delivery Information</h4>
      <form method="POST" action="{% url 'profiles:profile' %}" id="profile-update-form">
        {% csrf_token %}
        {{ form|crispy }}
        <button class="btn rounded-pill text-white mt-3"
                style="background-color: var(--accent-blue); border: none;">
          Update Information
        </button>
      </form>
    </div>

    <!-- Order History -->
    <div class="col-lg-6">
      <h4 class="text-accent-pink">Order History</h4>
      {% if orders %}
      <div class="table-responsive mt-3">
        <table class="table table-striped text-center">
          <thead style="background-color: var(--accent-blue); color: white;">
            <tr>
              <th>Order Number</th>
              <th>Date</th>
              <th>Total</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for order in orders %}
            <tr>
              <td>{{ order.order_number }}</td>
              <td>{{ order.date|date:"M d, Y" }}</td>
              <td>£{{ order.grand_total|floatformat:2 }}</td>
              <td>
                <a href="{% url 'profiles:order_history' order.order_number %}"
                   class="btn btn-sm rounded-pill text-white"
                   style="background-color: var(--accent-pink); border: none;">
                  View
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <p class="text-muted">You haven’t placed any orders yet.</p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
